<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
 <mapper namespace="mybatis.mapper.review">
	
	<resultMap type="review" id="reviewVo">
	
		<result column="review_number" property="review_number"/>
		<result column="product_number" property="product_number"/>
		<result column="member_number" property="member_number"/>
		<result column="review_content" property="review_content"/>
		<result column="review_regdate" property="review_regdate"/>
		<result column="order_number" property="order_number"/>
		<result column="member_nickname" property="member_nickname"/>
		<result column="product_name" property="product_name"/>
		
	</resultMap>
	
	 <insert id="insertReview" parameterType="review">
		INSERT INTO M_REVIEW
		 VALUES(REVIEW_NUMBER_SEQ.NEXTVAL,#{product_number},#{member_number},#{review_content},SYSDATE,#{order_number})
	</insert>
	
	<select id="listReview" resultMap="reviewVo">
		select * from m_review where order_number = #{order_number}
	</select>	
	
	<select id="reviewList" resultMap="reviewVo" parameterType="long">
		select member_nickname, review_content, review_regdate
		from m_member m, m_review r
		where r.member_number = m.member_number and product_number = #{product_number}
	 </select>
	<select id="listMyReview" resultMap="reviewVo" parameterType="long">
		select review_content, review_regdate, product_name
		from m_review r, m_product p, m_member m
		where p.product_number = r.product_number and m.member_number= #{member_numbe}
	</select>
	
	
	
</mapper>
